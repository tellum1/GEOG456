<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Townes Ellum Leaflet HW 7</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
    integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
    crossorigin=""></script>
    <script src="EAB_infested_counties_clipped_smaller.js"></script>
    <script src="EAB_EDD_pointdataclean.js"></script>
    <script src="iNat_EAB_obs.js"></script>
    <script src="iNat_ash_obs1.js"></script>
    <!-- <script src="b10_year_buffer.js"></script> -->
</head>

<style>
    #map {
        width: 80%;
        margin: 0 10%; /* 20% margin on each side */
        height: 600px;
        background-color: lightblue;
    }
</style>

<style>
    body {
        background-color: lightgreen;
    }
</style>

<body>

<!-- <h1>Spread of the Emerald Ash Borer in the United States: Past, Present and...Future?</h1>
<h2>GEOG456 Final Project</h2>
<h3>Townes Ellum </h3>
<h3 id="daYear">Year</h3>
<input id="yearSlider" type="range" name="year" min="2001" max="2024" oninput="moveSlider(this.value)" value="2001">
<br><br>
<div id="map"></div> -->
<style>
    .container {
        text-align: center;
    }
</style>

<div class="container">
    <h1>Spread of the Emerald Ash Borer in the United States: Past, Present and...Future?</h1>
    <h2>GEOG456 Final Project</h2>
    <h3>Townes Ellum </h3>
    <h3 id="daYear">Year</h3>
    <input id="yearSlider" type="range" name="year" min="2001" max="2024" oninput="moveSlider(this.value)" value="2001">
    <br><br>
</div>
<div id="map"></div>

<style>
    .legend {
        font-family: 'Times New Roman', Times, serif;
        background-color: burlywood;
        padding: 10px;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        position: absolute;
        top: 10px;
        right: 10px;
    }
    .legend-item {
        margin-bottom: 5px;
    }
    .legend-color {
        width: 20px;
        height: 20px;
        border-radius: 50%; /* Make the shape circle */
        display: inline-block;
        vertical-align: middle;
        margin-right: 5px;
    }
</style>
</head>
<body>
<div class="legend">
    <div class="legend-item">
        <span class="legend-color" style="background-color: blue;"></span> Water
    </div>
    <div class="legend-item">
        <span class="legend-color" style="background-color: green;"></span> Forest
    </div>
    <div class="legend-item">
        <span class="legend-color" style="background-color: #f7dc6f;"></span> Farmland
    </div>
    <!-- Add more items as needed -->
</div>
</body>



</body>
<script>
    var map = L.map('map').setView([35.75, -100.39], 4);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    }).addTo(map);

    function myStyleCounty(features) {
        return {
            color: getColorCounty(features.properties.PPQ_EAB__6),
            weight: 1,
            opacity: 1,
            fillOpacity: 1
        }
    };

    function myStylePointEDD(features) {
        return {
            fillColor: getColorPointEDD(features.properties.year),
            color: "#8a00c2",
            weight: 1,
            opacity: 0,
            fillOpacity: 0.8,
            radius: 1
        };
    };

    function myStylePointiNat(features) {
        return {
            fillColor: getColorPointiNat(features.properties.year),
            color: "#8a00c2",
            weight: 1,
            opacity: 0,
            fillOpacity: 0.8,
            radius: 1
        };
    };

    function myStylePointiNatASH(features) {
        return {
            fillColor: getColorPointiNatASH(features.properties.year),
            color: "#0000ff",
            weight: 1,
            opacity: 0,
            fillOpacity: 0.8,
            radius: 2
        };
    };

    // function myStyle10ybuffer(features) {
    //     return {
    //         fillColor: getColor10ybuffer(features.properties.year),
    //         weight: 1,
    //         opacity: 1,
    //         fillOpacity: 1
    //     }
    // };


function getColorCounty(d) {
    var difference = myCurrentSelectionYear - d;
    var transparency = 1-(difference / 24); // Assuming the range is from 2001 to 2024
    var greenValue = 255 - Math.floor((255 - 80) * transparency);

    return d < (myCurrentSelectionYear + 1) ? "rgb(0, " + greenValue + ", 0)" : "transparent";
}

    function getColorPointEDD(d) {
        return d < (myCurrentSelectionYear + 1) ? "red" : "transparent";
    }

    function getColorPointiNat(d) {
        return d < (myCurrentSelectionYear + 1) ? "red" : "transparent";
    }

    function getColorPointiNatASH(d) {
        return d < (myCurrentSelectionYear + 1) ? "yellow" : "yellow";
    }

    // function getColor10ybuffer(d) {
    //     return d < (myCurrentSelectionYear + 1) ? "blue" : "blue";
    // }

    var geojsonPointiNatASH = L.geoJSON(iNat_ash_obs1, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, myStylePointiNatASH(feature));
        }
    }).addTo(map);
    // var b10_year_buffer = L.geoJSON(b10_year_buffer, {style: myStyle10ybuffer}).addTo(map);
    var geojsonCounty = L.geoJSON(EAB_inf_counties, {style: myStyleCounty}).addTo(map);
    var geojsonPointEDD = L.geoJSON(EAB_EDD_pointdataclean, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, myStylePointEDD(feature));
        }
    }).addTo(map);
    var geojsonPointiNat = L.geoJSON(iNat_EAB_obs, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, myStylePointiNat(feature));
        }
    }).addTo(map);

    var myCurrentSelectionYear = 2001;

    function moveSlider(value) {
        document.getElementById('daYear').innerHTML = 'Year: ' + value;
        geojsonPointiNatASH.eachLayer(function (layer) {
            layer.setStyle(myStylePointiNatASH(layer.feature));
        });
        myCurrentSelectionYear = value;
        // b10_year_buffer.resetStyle();
        geojsonCounty.resetStyle();
        geojsonPointEDD.eachLayer(function (layer) {
            layer.setStyle(myStylePointEDD(layer.feature));
        });
        geojsonPointiNat.eachLayer(function (layer) {
            layer.setStyle(myStylePointiNat(layer.feature));
        });
    }
   
    moveSlider(myCurrentSelectionYear);

    window.onload = function() {
        document.getElementById('yearSlider').value = 1840;  
    };

</script>   
<br>
<a href="https://usda-mrp.maps.arcgis.com/home/item.html?id=1dfcee71467846d6ac8beea04d2cf6b3">
    Link to Data Source (USDA)</a>
</br>
</html>
